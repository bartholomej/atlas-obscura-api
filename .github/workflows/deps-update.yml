name: â¬†ï¸ Weekly Dependency Update

on:
  schedule:
    - cron: '0 9 * * 1'
  workflow_dispatch:

jobs:
  update-dependencies:
    name: ğŸ“¦ Update and Test
    runs-on: ubuntu-latest
    steps:
      - name: ğŸšš Checkout repository
        uses: actions/checkout@v6

      - name: ğŸŸ¢ Setup Node.js 24
        uses: actions/setup-node@v4
        with:
          node-version: '24'

      - name: ğŸ› ï¸ Enable Corepack & Yarn 4
        run: |
          corepack enable
          corepack prepare yarn@4 --activate

      - name: ğŸ“¥ Install dependencies
        run: yarn install --immutable

      - name: â¬†ï¸ Update dependencies
        run: yarn up "*"

      - name: ğŸ—ï¸ Build application
        run: yarn build

      - name: ğŸ—ï¸ Run demo
        run: yarn demo

      - name: ğŸ§ª Run tests
        run: yarn test --watch=false

      - name: ğŸ”€ Create Pull Request
        uses: peter-evans/create-pull-request@v8
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: 'chore(deps): update all deps'
          title: 'chore(deps): update all deps'
          body: |
            Automated Pull Request to update dependencies.
            Executed using Node 24 and Yarn 1.22.

            All tests passed successfully with the new versions.
          branch: 'chore/auto-deps-update'
          delete-branch: true
